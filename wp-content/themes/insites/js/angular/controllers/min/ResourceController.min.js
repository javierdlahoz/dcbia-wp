angular.module("angular-wp").controller("ResourceController",function(e,r,s,o,u,c){e.orderby="title",e.stakeholders=["*"],e.resourceType=["*"],e.resources={},e.resources.resources=[],e.areasOfFocus=[];var a=10;e.page=1,jQuery("#home").removeClass("active"),e.getResourceFormats=function(){o.getResourceFormats(function(r){e.resourceFormats=r})},e.getAreasOfFocus=function(){o.getAreasOfFocus(function(r){e.resourceFormats=r})},e.getResourceTypes=function(){o.getResourceTypes(function(r){e.resourceFormats=r})},e.getResourceStakeholders=function(){o.getResourceStakeholders(function(r){e.resourceFormats=r})},e.getQueryValue=function(){return(""==e.query||void 0==e.query)&&(e.query=jQuery("#query").val()),c.set("queryval",e.query),e.query},e.getAreasOfFocusValue=function(){return(""==e.areasOfFocus||void 0==e.areasOfFocus)&&(e.areasOfFocus=[jQuery("#area-of-focus").val()]),e.areasOfFocus},e.setAreasOfFocus=function(r,s){(e.areasOfFocus.indexOf("*")>=0||s===!0)&&(e.areasOfFocus=[]),"*"===r?e.areasOfFocus=["*"]:e.checkIfValueExistsInObject(r,e.areasOfFocus)||e.areasOfFocus.push(r),e.page=1,c.set("areasOfFocus",e.areasOfFocus)},e.setStakeholders=function(r){e.stakeholders.indexOf("*")>=0&&(e.stakeholders=[]),"*"===r?e.stakeholders=["*"]:e.checkIfValueExistsInObject(r,e.stakeholders)||e.stakeholders.push(r),c.set("stakeholders",e.stakeholders),e.page=1},e.setOrderBy=function(r){e.orderby=r,c.set("orderby",e.orderby)},e.setQuery=function(r){e.query=r,jQuery("#query_from_post").val("")},e.setResourceType=function(r){e.resourceType.indexOf("*")>=0&&(e.resourceType=[]),"*"===r?e.resourceType=["*"]:e.checkIfValueExistsInObject(r,e.resourceType)||e.resourceType.push(r),c.set("resourceType",e.resourceType),e.page=1,e.searchResources()},e.searchResources=function(){e.resources.resources=[],e.page=1,e.getDataPaged(1)},e.deleteResourceFile=function(e){o.deleteResourceFile(e,function(){})},e.queryinit=function(){var r=!1;e.loading=!1,e.areasOfFocus=[],e.getDataPaged=function(s){r=!0,e.loading=!0,u(function(){"resource"===c.get("referer")&&(c.get("queryval")&&(e.query=c.get("queryval")),c.get("areasOfFocus")&&(e.areasOfFocus=c.get("areasOfFocus")),c.get("stakeholders")&&(e.stakeholders=c.get("stakeholders")),c.get("orderby")&&(e.orderby=c.get("orderby")),c.get("resourceType")&&(e.resourceType=c.get("resourceType")),c.remove("referer")),""!==jQuery("#query_from_post").val()&&(e.query=jQuery("#query_from_post").val());var u={query:e.getQueryValue(),orderby:e.orderby,stakeholders:e.stakeholders,"areas-of-focus":e.getAreasOfFocusValue(),"resource-types":e.resourceType,paged:s};o.getResources(u,function(o){if(e.resources.facets=o.facets,e.resources.count=o.count,o.resources){1==s&&(e.resources.resources=[]);var u;for(u=0;u<o.resources.length;u++)e.resources.resources.push(o.resources[u])}e.resourcesFound=null==e.resources.resources?0:o.count,r=!1,e.loading=!1,e.page++})},800)},e.increasePaged=function(){!(e.page<=Math.ceil(e.resourcesFound/a))&&e.resourcesFound||r||e.getDataPaged(e.page)}},jQuery(".secondary-nav a").click(function(e){e.preventDefault()}),e.checkIfValueExistsInObject=function(e,r){for(i in r)if(r[i]===e)return!0;return!1}});