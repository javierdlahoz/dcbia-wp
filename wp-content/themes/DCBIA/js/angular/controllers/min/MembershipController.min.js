angular.module("angular-wp").controller("MembershipController",function(e,t,s){e.users={},e.c=-1,e.usernameTaken=!1,e.isSuccess=!1,e.billing={},e.membershipCost=null,e.add=function(){e.c++;var t=e.c;e.users[t]={id:t,first_name:"",last_name:"",email:"",password:"",committee:""}},e.remove=function(t){delete e.users[t]},e.initialize=function(){e.users={}},e.setCity=function(){"object"==typeof e.member.city&&(e.member.state=e.member.city.address_components[1].short_name,e.member.city=e.member.city.address_components[0].long_name)},e.register=function(){var s="/api/member/register";e.member.additional_users=e.users,t({url:s,method:"POST",data:jQuery.param(e.member),headers:getContentTypes().form}).success(function(){e.isSuccess=!0,window.location="/checkout"})},e.getMembershipLevels=function(){var s="/api/member/levels";t({url:s,method:"GET"}).success(function(t){e.membershipLevels=t})},e.setMembershipCost=function(){e.membershipCost=e.membershipLevels[e.member.membership_level-1].initial_payment},e.getAdditionalUsers=function(){var s="/api/member/affiliates";t({url:s,method:"GET"}).success(function(t){e.users=t.affiliates,e.c=t.affiliates.length-1,console.log(e.c)})},e.setAdditionalUsers=function(){var s="/api/member/affiliates";e.member={},e.member.additional_users=e.users,t({url:s,method:"POST",data:jQuery.param(e.member),headers:getContentTypes().form}).success(function(){e.isSuccess=!0,window.location="/checkout"})},e.isUsernameTaken=function(){if(e.member.username.length>4){var s="/api/member/check";t({url:s,method:"POST",data:jQuery.param({username:e.member.email}),headers:getContentTypes().form}).success(function(t){e.usernameTaken=t.is_taken})}},e.charge=function(){e.billing.expiration_date=e.billing.expiration_month+e.billing.expiration_year,e.billing.country="US";var r="/api/member/pay";t({url:r,method:"POST",data:jQuery.param(e.billing),headers:getContentTypes().form}).success(function(t){e.billing.status=t.status,1==t.status&&s(function(){window.location="/"},5e3)})},e.getCurrentUser=function(){var s="/api/member/current";t({url:s,method:"GET"}).success(function(t){t.first_name!==!1&&(e.member=t,e.users=t.affiliates)})},angular.element("#address").attr("g-places-autocomplete",""),angular.element("#address").attr("ng-model","address"),angular.element("#city").attr("ng-model","city"),angular.element("#state").attr("ng-model","state")});